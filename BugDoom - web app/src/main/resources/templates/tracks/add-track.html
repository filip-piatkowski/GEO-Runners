<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.w3.org/1999/xhtml"
      layout:decorate="~{fragments/main_view}">
<head>
    <meta charset="UTF-8">
<!--  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"-->
<!--        integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="-->
<!--        crossorigin=""/>-->

<!--  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"-->
<!--          integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="-->
<!--          crossorigin=""></script>-->

  <link   href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
          crossorigin="anonymous"/>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
  <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
          crossorigin="anonymous">
  </script>
<!--  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>-->

  <title>New track</title>
<!--  <style>#map { height: 400px; }</style>-->
</head>
<body>
<div layout:fragment ="content" class="container text-left">
  <h1 >Nowa trasa</h1>
  <form th:action="@{/tracks}" th:object="${track}" method="post">
    <div style="margin-top: 5px">
    <p>Nazwa biegu: <input type="text" placeholder="Nazwa nowego biegu" th:field="*{competitionName}"/></p>
    </div>
    <div style="margin-top: 5px" >Poziom trudności:
      <input type="radio" id="difficultyChoice1" name="difficulty" value="łatwy"/>
      <label for="terrainChoice1">łatwy</label>
      <input type="radio" id="difficultyChoice2" name="difficulty" value="średni"/>
      <label for="terrainChoice2">średni</label>
      <input type="radio" id="difficultyChoice3" name="difficulty" value="trudny" th:field="*{difficulty}"/>
      <label for="terrainChoice3">trudny</label>
    </div>
    <p>Dystans (km): <input id="length_input" type="range" min="2" max="20" step="1" th:field="*{length}"/>
      <output id="value"></output>
    </p>
    <div style="margin-top: 5px"> Lokalizacja: <input type="radio" id="terrainChoice1" name="terrain" value="miejski"/>
      <label for="terrainChoice1">miejski</label>
      <input type="radio" id="terrainChoice2" name="terrain" value="leśny"/>
      <label for="terrainChoice2">leśny</label>
      <input type="radio" id="terrainChoice3" name="terrain" value="górzysty" th:field="*{terrain}"/>
      <label for="terrainChoice3">górzysty</label>
    </div>
    <div>
      <label for="event">Wydarzenie: </label>
      <select id="event" class="form-control" name="event.eventId">
        <option value="-1" th:text="#{track.select-event}"></option>
        <option th:each="event : ${allEvents}"
                th:value="${event.eventId}"
                th:text="${event.eventName}"></option>
      </select>
    </div>

    <div>
      <input type="text" id="locations" name="locations" min="2" max="10" th:field="*{locations}" value="">Ilość checkpointów:<br/>
      <button type="button" id="fill-details" onclick="addFields()">Dodaj checkpointy (2-10)</button>
      <div id="container"/>
    </div>

    <div id="map" class="container"></div>

    <ul th:if="${#fields.hasErrors('*')}">
      <li th:each="err : ${#fields.errors('*')}" th:text="${err}"></li>
    </ul>
    <p><input class="btn btn-success" type="submit" value="Zatwierdź"/>
      <input class="btn btn-secondary" type="reset" value="Zresetuj"/></p>
  </form>
  <script>
    const value = document.querySelector("#value")
    const input = document.querySelector("#length_input")
    value.textContent = input.value
    input.addEventListener("input", (event) => {
      value.textContent = event.target.value
    })
  </script>

  <script>
    function addFields() {
      var number = document.getElementById("locations").value;
      var container = document.getElementById("container");
      while (container.hasChildNodes()) {
        container.removeChild(container.lastChild);
      }
      for (i = 0; i < number; i++) {
        container.appendChild(document.createTextNode("Checkpoint " + (i + 1)));

        var input = document.createElement("input");
        input.type = "text";
        input.name = "location[" + i + "]";
                container.appendChild(input);

        //
        // var latitudeInput = document.createElement("input");
        // latitudeInput.type = "text";
        // latitudeInput.name = "checkpoint[" + i + "].latitude";
        // container.appendChild(latitudeInput);
        //
        // var longitudeInput = document.createElement("input");
        // longitudeInput.type = "text";
        // longitudeInput.name = "checkpoint[" + i + "].longitude";
        // container.appendChild(longitudeInput);

        container.appendChild(document.createElement("br"));
      }
    }
  </script>

  <a href="/tracks" class="btn btn-primary"><i class="fas fa-angle-double-left"></i> Powrót do listy tras</a>
</div>

</body>
</html>